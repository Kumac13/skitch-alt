<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:">
  <title>Skitch Alt</title>
  <link rel="stylesheet" href="style.css">
  <script src="fabric.min.js"></script>
</head>
<body>
  <div class="app-container">
    <!-- Toolbar -->
    <div class="toolbar">
      <div class="toolbar-section">
        <button class="tool-btn" id="btn-capture" title="Capture Screenshot">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M4,4H7L9,2H15L17,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4M12,7A5,5 0 0,0 7,12A5,5 0 0,0 12,17A5,5 0 0,0 17,12A5,5 0 0,0 12,7M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9Z"/>
          </svg>
        </button>
        <button class="tool-btn" id="btn-open" title="Open File">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z"/>
          </svg>
        </button>
        <button class="tool-btn" id="btn-clear" title="Clear Canvas">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/>
          </svg>
        </button>
      </div>
      <div class="toolbar-divider"></div>
      <div class="toolbar-section">
        <button class="tool-btn" id="btn-arrow" title="Arrow Tool" disabled>
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M5,17.59L15.59,7H9V5H19V15H17V8.41L6.41,19L5,17.59Z"/>
          </svg>
        </button>
        <button class="tool-btn" id="btn-text" title="Text Tool" disabled>
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M5,4V7H10.5V19H13.5V7H19V4H5Z"/>
          </svg>
        </button>
        <button class="tool-btn" id="btn-rect" title="Rectangle Tool" disabled>
          <svg viewBox="0 0 24 24" width="20" height="20">
            <rect x="3" y="3" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
        <button class="tool-btn" id="btn-mosaic" title="Mosaic Tool" disabled>
          <svg viewBox="0 0 24 24" width="20" height="20">
            <rect x="5" y="5" width="6" height="6" fill="currentColor"/>
            <rect x="13" y="5" width="6" height="6" fill="currentColor" opacity="0.6"/>
            <rect x="5" y="13" width="6" height="6" fill="currentColor" opacity="0.6"/>
            <rect x="13" y="13" width="6" height="6" fill="currentColor"/>
          </svg>
        </button>
        <div class="color-picker-wrapper">
          <input type="color" id="color-picker" value="#ff0000">
          <span class="color-preview" id="color-preview"></span>
        </div>
        <select id="stroke-width" class="stroke-select" title="Stroke Width">
          <option value="2">S</option>
          <option value="4" selected>M</option>
          <option value="6">L</option>
        </select>
      </div>
      <div class="toolbar-spacer"></div>
      <div class="toolbar-section save-section">
        <div class="save-dropdown" id="save-dropdown">
          <button class="tool-btn save-btn" id="btn-save" title="Copy to Clipboard" disabled>
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/>
            </svg>
          </button>
          <button class="dropdown-toggle" id="btn-save-toggle" title="Save Options" disabled>
            <svg viewBox="0 0 24 24" width="12" height="12">
              <path fill="currentColor" d="M7,10L12,15L17,10H7Z"/>
            </svg>
          </button>
          <div class="dropdown-menu" id="save-menu">
            <button class="dropdown-item" id="save-clipboard">
              <svg viewBox="0 0 24 24" width="16" height="16">
                <path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/>
              </svg>
              Copy to Clipboard
            </button>
            <button class="dropdown-item" id="save-file">
              <svg viewBox="0 0 24 24" width="16" height="16">
                <path fill="currentColor" d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/>
              </svg>
              Save to File...
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Canvas Area -->
    <div class="editor-area" id="editor-area">
      <canvas id="canvas"></canvas>
      <div class="canvas-placeholder" id="canvas-placeholder">
        <p>Capture a screenshot or open an image file</p>
        <div class="placeholder-buttons">
          <button id="placeholder-capture">Capture Screenshot</button>
          <button id="placeholder-open">Open File</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Permission Dialog -->
  <div class="permission-dialog-overlay" id="permission-dialog" style="display: none;">
    <div class="permission-dialog">
      <div class="permission-dialog-icon">
        <svg viewBox="0 0 24 24" width="48" height="48">
          <path fill="currentColor" d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.1 14.8,9.5V11C15.4,11 16,11.6 16,12.3V15.8C16,16.4 15.4,17 14.7,17H9.2C8.6,17 8,16.4 8,15.7V12.2C8,11.6 8.6,11 9.2,11V9.5C9.2,8.1 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,9.5V11H13.5V9.5C13.5,8.7 12.8,8.2 12,8.2Z"/>
        </svg>
      </div>
      <h2>Screen Recording Permission Required</h2>
      <p>To capture screenshots, this app needs screen recording permission.</p>
      <p class="permission-dialog-hint">After granting permission, please restart the app.</p>
      <div class="permission-dialog-buttons">
        <button class="permission-btn-secondary" id="permission-later">Later</button>
        <button class="permission-btn-primary" id="permission-open-settings">Open Settings</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
